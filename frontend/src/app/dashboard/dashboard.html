<div class="dashboard-wrapper">
  <header class="top-bar">
    <h1>ðŸš€ Delivery Tracker</h1>
    <div class="stats">In carico: {{ deliveries.length }} consegne</div>
  </header>

  <main class="content">
    <section class="form-section">
      <div class="form-card">
        <h3>Nuova Spedizione</h3>
        <div class="input-group">
          <input [(ngModel)]="newDelivery.destinatario" placeholder="ðŸ‘¤ Nome Destinatario">
          <input [(ngModel)]="newDelivery.indirizzo" placeholder="ðŸ“ Indirizzo di consegna">
          <input [(ngModel)]="newDelivery.fascia_oraria" placeholder="â° Fascia Oraria">
          <select [(ngModel)]="newDelivery.priorita">
            <option value="LOW">PrioritÃ  Bassa</option>
            <option value="MEDIUM">PrioritÃ  Media</option>
            <option value="HIGH">PrioritÃ  ALTA</option>
          </select>
          <button (click)="onSubmit()" [disabled]="isProcessing" [class.loading]="isProcessing">
            {{ isProcessing ? 'Creazione...' : 'Crea Spedizione' }}
          </button>
        </div>
      </div>
    </section>

    <section class="grid">
      <div *ngFor="let d of deliveries" 
           class="delivery-card" 
           [ngClass]="d.stato.toLowerCase()"
           [class.high-priority]="d.priorita === 'HIGH'">
        
        <div class="priority-badge" *ngIf="d.priorita === 'HIGH'">HIGH</div>
        
        <div class="card-header">
          <span class="trk-code">#{{ d.tracking_code }}</span>
          <span class="status-dot"></span>
        </div>

        <div class="card-body">
          <h3>{{ d.destinatario }}</h3>
          <p class="address">{{ d.indirizzo }}</p>
          <p class="time">Fascia: {{ d.fascia_oraria }}</p>
          <p class="status-text">Stato attuale: <strong>{{ d.stato.replace('_', ' ') }}</strong></p>
        </div>

        <div class="card-actions">
          <button (click)="onUpdateStatus(d.id, 'READY')" [disabled]="isProcessing">READY</button>
          <button (click)="onUpdateStatus(d.id, 'OUT_FOR_DELIVERY')" [disabled]="isProcessing">OUT</button>
          <button (click)="onUpdateStatus(d.id, 'DELIVERED')" [disabled]="isProcessing">DONE</button>
          <button (click)="onUpdateStatus(d.id, 'FAILED')" [disabled]="isProcessing">FAIL</button>
        </div>
      </div>
    </section>
  </main>
</div>